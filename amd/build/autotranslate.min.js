define("filter_autotranslate/autotranslate",["core/ajax","core/notification"],(function(Ajax,Notification){function pollTaskStatus(taskid){Ajax.call([{methodname:"filter_autotranslate_task_status",args:{taskid:taskid},done:function(response){var progressbar=document.querySelector("#task-progress .progress-bar");progressbar&&(progressbar.style.width=response.percentage+"%",progressbar.setAttribute("aria-valuenow",response.percentage),progressbar.textContent=response.percentage+"%","failed"===response.status&&(progressbar.classList.remove("bg-primary"),progressbar.classList.add("bg-danger"))),"completed"===response.status?(Notification.addNotification({message:"Task completed. Reloading page...",type:"success"}),setTimeout((function(){location.reload()}),1e3)):"failed"===response.status?(Notification.addNotification({message:"Task failed. Check logs for details.",type:"error"}),resetUI()):setTimeout((function(){pollTaskStatus(taskid)}),1e3)},fail:function(error){Notification.addNotification({message:"Error checking status: "+error.message,type:"error"});var progressbar=document.querySelector("#task-progress .progress-bar");progressbar&&(progressbar.classList.remove("bg-primary"),progressbar.classList.add("bg-danger")),resetUI()}}])}function resetUI(){var autotranslatebutton=document.getElementById("autotranslate-button");autotranslatebutton&&autotranslatebutton.removeAttribute("disabled");var progresscontainer=document.getElementById("task-progress");progresscontainer.style.display="none";var progressbar=progresscontainer.querySelector(".progress-bar");progressbar&&(progressbar.style.width="0%",progressbar.setAttribute("aria-valuenow","0"),progressbar.textContent="0%")}return{init:function(){var autotranslatebutton=document.getElementById("autotranslate-button");autotranslatebutton&&autotranslatebutton.addEventListener("click",(function(){!function(methodname,params){var autotranslatebutton=document.getElementById("autotranslate-button");autotranslatebutton&&autotranslatebutton.setAttribute("disabled","disabled");var progresscontainer=document.getElementById("task-progress");progresscontainer.style.display="block";var progressbar=progresscontainer.querySelector(".progress-bar");progressbar.classList.remove("bg-danger"),progressbar.classList.add("bg-primary"),progressbar.style.width="0%",progressbar.setAttribute("aria-valuenow","0"),progressbar.textContent="0%",Ajax.call([{methodname:methodname,args:params,done:function(response){response.success&&response.taskid?(Notification.addNotification({message:"Task queued successfully. Awaiting completion.",type:"success"}),pollTaskStatus(response.taskid)):(Notification.addNotification({message:response.message||"Failed to queue task.",type:"error"}),resetUI())},fail:function(error){Notification.addNotification({message:"Error queuing task: "+error.message,type:"error"}),resetUI()}}])}("filter_autotranslate_autotranslate",JSON.parse(autotranslatebutton.getAttribute("data-filter-params")))}))}}}));

//# sourceMappingURL=autotranslate.min.js.map